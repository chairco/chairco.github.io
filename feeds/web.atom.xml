<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Jason's Blog</title><link href="https://chairco.me/" rel="alternate"></link><link href="https://chairco.me/feeds/web.atom.xml" rel="self"></link><id>https://chairco.me/</id><updated>2017-10-21T14:20:38+08:00</updated><entry><title>個人網站申請一個網域名與掛上免費 https</title><link href="https://chairco.me/posts/2017/10/Apply%20a%20domain%20name%20and%20https%20for%20personal%20websit.html" rel="alternate"></link><published>2017-10-21T14:20:38+08:00</published><author><name>chairco(Jason)</name></author><id>tag:chairco.me,2017-10-21:posts/2017/10/Apply a domain name and https for personal websit.html</id><summary type="html">&lt;blockquote&gt;
&lt;p&gt;前不久有寫過一篇文章 &lt;a href="/posts/2017/06/Github.io%20Pages%20redirect%20to%20domain%20name%20and%20add%20HTTPS.html"&gt;Github.io 自訂網域名稱且透過 Cloudflare 申請免費 https&lt;/a&gt; 分享如何用免費的 Cloudflare 替網站掛上 &lt;span class="caps"&gt;HTTPS&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;時隔一陣，我原始的網域名 &lt;strong&gt;chairco.com.tw&lt;/strong&gt; 也到期了。掙扎很久再想到底要不要續約，但一直覺得 &lt;code&gt;com.tw&lt;/code&gt; 網域名稱很怪，但 &lt;code&gt;com&lt;/code&gt; 又被買走，&lt;code&gt;tw&lt;/code&gt; 有點狹隘感覺。既然網站是個人的知識與經驗分享，那就找個比較個人 style 的吧。所以 &lt;code&gt;me&lt;/code&gt; 就成了我的選擇了。&lt;/p&gt;
&lt;p&gt;不過重新購買過程出現小插曲，&lt;code&gt;Gandi&lt;/code&gt;(網域名稱服務商) 似乎這一陣子改版了他們系統，原先是在一個稱為 &lt;a href="https://v4.gandi.net/news/en/2012-10-23/798-gandi_v4_is_live/?lang=zh-hant"&gt;v4&lt;/a&gt; 網站上註冊與購買，但我透過他寄來提醒信連結到是 &lt;a href="https://v5.gandi.net/zh-hant"&gt;v5&lt;/a&gt;。原本帳號無法通用在兩個系統，另外申請了一組帳號。結果一時不察在 v5&amp;nbsp;系統上用了後來新申請帳號購買，只好將錯就錯了。&lt;/p&gt;
&lt;p&gt;新的網頁系統可能為了更人性化所以在流程與 &lt;span class="caps"&gt;UI&lt;/span&gt; 有調整，和舊的差距不小。因此再次記錄透過 Gandi 購買網域名稱和申請免費 https&amp;nbsp;的過程。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;購買網域名&lt;/h2&gt;
&lt;p&gt;進到 Gandi v5 的新網頁如下，可以打你想要的網域名稱進行購買與註冊，範例我用 &lt;code&gt;g0v.tw&lt;/code&gt; 來舉例。&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/6THSbpw.png" /&gt;&lt;/p&gt;
&lt;p&gt;因為 &lt;code&gt;g0v.tw&lt;/code&gt; 已經被註冊了，所以推薦了幾個尚未註冊的網域名稱。不知道如何定價，但我猜應該就是根據市場上的熱度，比較有趣是 &lt;code&gt;cn&lt;/code&gt; 網域似乎需要申請文件。&lt;/p&gt;
&lt;p&gt;假設你選定了某個網域，就點選之後再按右上角購物車結帳。&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/WoE5j8f.png" /&gt;&lt;/p&gt;
&lt;p&gt;接著會進到購物車畫面。在這邊如果你有參加一些研討會例如：&lt;a href="https://tw.pycon.org/2017/zh-hant/"&gt;PyCon &lt;span class="caps"&gt;TW&lt;/span&gt;&lt;/a&gt; 有 Gandi&amp;nbsp;贊助可能會得到一些第一年免費的序號，可以拿來用，但天下沒有白吃午餐，第二年開始通常就是恢復原價。如果有想要長期經營就選好選滿不要和我一樣。&lt;/p&gt;
&lt;p&gt;確定好一些加值稅等就可以按下結帳。&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/i4Biyo0.png" /&gt;&lt;/p&gt;
&lt;p&gt;因為目前為止都尚未登入，所以可以登入你申請帳號或是重新申請一個新的。然後 v4 無法和 v5 共用帳號（無法理解原因？是因為當初申請的帳號比較特殊嗎？是 Gandi-&amp;nbsp;開頭的）&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/pJgE8em.png" /&gt;&lt;/p&gt;
&lt;p&gt;接著會請你輸入一些發票必要資訊（當然要輸入假的也行）我也不知道為什麼一定需要？不過我是輸入真實的，反正網站上遠本就透露這些訊息。&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/wMvlC61.png" /&gt;&lt;/p&gt;
&lt;p&gt;然後如果想試試 Gandi 的 Hosting&amp;nbsp;可以免費試用十天，個人是取消省得麻煩。接著就結帳付錢吧。&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/UKRPPV1.png" /&gt;&lt;/p&gt;
&lt;p&gt;完成之後可以進入管理介面，到左邊&lt;code&gt;域名&lt;/code&gt;點選主畫面你剛剛購買的網域名稱來做設定吧。&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/wpB0jtZ.png" /&gt;&lt;/p&gt;
&lt;h2&gt;轉址到網域名稱&lt;/h2&gt;
&lt;p&gt;因為我們的網頁是掛在 &lt;code&gt;github.io&lt;/code&gt; 上，希望瀏覽器打入 &lt;code&gt;chairco.github.io&lt;/code&gt; 時可以轉址到我們的網域名。這個步驟會許要做兩件事：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;設定 Gandi &lt;code&gt;區域設定檔&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;增加 &lt;span class="caps"&gt;CNAME&lt;/span&gt; 在主機上: 建立 &lt;span class="caps"&gt;CNAME&lt;/span&gt; 檔案在 &lt;code&gt;github.io&lt;/code&gt; 的 &lt;code&gt;repo&lt;/code&gt; 內。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;設定區域設定檔&lt;/h3&gt;
&lt;p&gt;在&lt;code&gt;管理介面&lt;/code&gt;點選&lt;code&gt;網域名稱&lt;/code&gt;會看到如下面的圖。把原先的區域檔紀錄都刪除，增加三個。接著確認沒有打錯就儲存。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;名稱: a, ipv4:&amp;nbsp;192.30.252.153&lt;/li&gt;
&lt;li&gt;名稱: a, ipv4:&amp;nbsp;192.30.252.154&lt;/li&gt;
&lt;li&gt;名稱: &lt;span class="caps"&gt;CNAME&lt;/span&gt;, 主機名稱: {github&amp;nbsp;帳號}.github.io.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/1Vb91tA.png" /&gt;&lt;/p&gt;
&lt;h3&gt;主機上增加 &lt;span class="caps"&gt;CNAME&lt;/span&gt;&amp;nbsp;檔案&lt;/h3&gt;
&lt;p&gt;在 &lt;code&gt;github.io&lt;/code&gt; 的 repo 內新增一個 &lt;span class="caps"&gt;CNAME&lt;/span&gt; 檔案，裡面就寫你的網域名稱，例如 &lt;code&gt;chairco.me&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/3aEe3CB.png" /&gt;&lt;/p&gt;
&lt;p&gt;接著等一會兒吧（大概最快一分鐘），你在瀏覽器鍵入原本 &lt;code&gt;github.io&lt;/code&gt; 網址就會成功轉址到你購買的新網域名稱上。恭喜你踏出第一步囉。接著開始設定&amp;nbsp;https。&lt;/p&gt;
&lt;h2&gt;掛載免費 &lt;span class="caps"&gt;HTTPS&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;不講太多 https 是什麼，google 一下 wiki 可能更清楚也不會偏誤。因為如果是自己的主機其實還挺容易的，但因為我們是掛載在 &lt;code&gt;github&lt;/code&gt; 的主機，所以需要一些第三方服務，簡單說第三方服務的關係應該是：&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;【 Github.io 】&amp;lt;--&amp;gt;【 Gandi 】 &amp;lt;--&amp;gt;【 Cloudflare 】
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;所以概念上就不需要針對 &lt;code&gt;Github.io&lt;/code&gt; 上的 repo 做任何事，只要讓 Cloudflare 能夠收到 Gandi&amp;nbsp;傳過來的封包，要做到這件事情就是要：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;設定 Cloudflare 上 &lt;span class="caps"&gt;DNS&lt;/span&gt; 和 Gandi&amp;nbsp;的區域設定檔案內容相同。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;設定 Gandi 的 &lt;span class="caps"&gt;DNS&lt;/span&gt; 是 Cloudflare&amp;nbsp;提供的位置。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;假設你已經註冊了一個帳號，登入主畫面點選右上 &lt;code&gt;+Add site&lt;/code&gt; 會看到下面畫面，就輸入網域名稱先讓 Cloudflare 幫你偵測一些參數，偵測完成之後案 &lt;code&gt;setup continue&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/9Si5Mlc.png" /&gt;&lt;/p&gt;
&lt;p&gt;通常可能會抓到錯誤的 Gandi&amp;nbsp;區域設定檔(要和前面我在設定一樣才對)，沒關係就等完成後再來修正。接著會問你要不要使用付費，點選免費後下一步。&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/0SgJJZk.png" /&gt;&lt;/p&gt;
&lt;p&gt;接著會偵測你目前的 &lt;span class="caps"&gt;DNS&lt;/span&gt; 並請你將網域名稱服務商提供的 &lt;span class="caps"&gt;DNS&lt;/span&gt; 改成 Cloudflare&amp;nbsp;以下兩個。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;mario.ns.cloudflare.com&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;mira.ns.cloudflare.com&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/svNyeP2.png" /&gt;&lt;/p&gt;
&lt;p&gt;所以我們要回到 Gandi 的網站修改。點選&lt;code&gt;管理介面&lt;/code&gt;內的網域名稱將原本的 &lt;span class="caps"&gt;DNS&lt;/span&gt;&amp;nbsp;修改，接著儲存後離開。&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/qJWTjCH.png" /&gt;&lt;/p&gt;
&lt;p&gt;接著完成所有程序，可以點選 &lt;code&gt;Recheckserver&lt;/code&gt;(畫面裡被 google 翻譯的圖示擋住)。旁邊的描述有提到，最慢 &lt;span class="caps"&gt;SSL&lt;/span&gt; 的憑證可能會 24 hr&amp;nbsp;後生效。&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/Jb7coVG.png" /&gt;&lt;/p&gt;
&lt;p&gt;如果 Gandi 上的 &lt;span class="caps"&gt;DNS&lt;/span&gt;&amp;nbsp;有正確設定，那就會顯示如下面正確的圖示。&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/PzZdHq0.png" /&gt;&lt;/p&gt;
&lt;p&gt;最後一個步驟要設定 &lt;code&gt;page rules&lt;/code&gt; 才允許網頁通過。如果沒有做這個設定那 Cloudflare 就不知道從 &lt;code&gt;chairco.me&lt;/code&gt; 過來的網頁哪些要做 &lt;span class="caps"&gt;SSL&lt;/span&gt;&amp;nbsp;加密。&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/BfvjPpo.png" /&gt; &lt;/p&gt;
&lt;p&gt;點選 Cloudflare 上 Page rules，接著輸入 &lt;code&gt;{網域名稱}/*&lt;/code&gt;，因為全部通過所以用星號表示。&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/Oc4Wbvq.png" /&gt;&lt;/p&gt;
&lt;p&gt;就完成所有的程序了。以我的經驗應該頂多 30 mins 網站就會掛上&amp;nbsp;https。接著打開瀏覽器就開心地看到網頁上有憑證啦！&lt;/p&gt;
&lt;p&gt;&lt;img alt="Imgur" src="https://i.imgur.com/fDUFM88.png" /&gt; &lt;/p&gt;</summary><category term="Web"></category><category term="Gandi"></category><category term="Cloudflare"></category></entry><entry><title>Github.io 自訂網域名稱且透過 Cloudflare 申請免費 https</title><link href="https://chairco.me/posts/2017/06/Github.io%20Pages%20redirect%20to%20domain%20name%20and%20add%20HTTPS.html" rel="alternate"></link><published>2017-06-29T15:33:03+08:00</published><author><name>chairco(Jason)</name></author><id>tag:chairco.me,2017-06-29:posts/2017/06/Github.io Pages redirect to domain name and add HTTPS.html</id><summary type="html">&lt;hr /&gt;
&lt;p&gt;這個部落格也快一年，雖然進化得很慢但還是有在進步。最近進步的一件事（應該不能說是進步，要說跟上）終於想把用了很久的 &lt;a href="https://chairco.github.io"&gt;blog&lt;/a&gt; 掛上網域名稱（之前是把網域名稱導過來 chairco.github.io,&amp;nbsp;喂，你搞什麼啊！！）&lt;/p&gt;
&lt;p&gt;大概半年前在 Gandi 有申請一個 chairco.com.tw 的網域，不過當時比較麻煩問題是不知道怎麼掛上 https，查一下解法是買一個主機架設 &lt;span class="caps"&gt;DNS&lt;/span&gt;，但就有點貴了。 Gandi&amp;nbsp;似乎有提供免費？但可能我是免費一年序號，所以要花錢買，大概沒有繼續處理就這樣苟且偷生下去了。&lt;/p&gt;
&lt;p&gt;主要是最近 &lt;strong&gt;pay.taipei&lt;/strong&gt; (&lt;a href="https://www.facebook.com/schreibmal/media_set?set=a.10212928669916690.1073741842.1388906446&amp;amp;type=3&amp;amp;pnref=story"&gt;事件緣起&lt;/a&gt;) 然後看到很多人在講這件事，結果很多部落主在批評時也被反說他的網站也沒做 &lt;span class="caps"&gt;HTTPS&lt;/span&gt;。心裡覺得要洗別人臉自己臉真的要洗乾淨所以就決定來完成它了。&lt;/p&gt;
&lt;p&gt;架設 Blog、自訂網域名稱、設定 https&amp;nbsp;主要分成三塊服務商：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Github：靜態網頁&lt;/li&gt;
&lt;li&gt;Gandi：網域名稱供應商&lt;/li&gt;
&lt;li&gt;Cloudflare：提供 &lt;span class="caps"&gt;DNS&lt;/span&gt;、&lt;span class="caps"&gt;HTTPS&lt;/span&gt;&amp;nbsp;傳輸服務&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Github&lt;/h2&gt;
&lt;p&gt;大概多數靜態網頁都很容易架設，可以參考完整的&lt;a href="https://pages.github.com/"&gt;官方教學&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Gandi&lt;/h2&gt;
&lt;p&gt;網域名稱供應商，註冊之後可以付費購買網域名稱，網域名稱購買之後要怎麼讓 github.io 轉址，就只需要在 github.io 靜態網頁下建立一個 &lt;span class="caps"&gt;CNAME&lt;/span&gt;。另外也要編輯在 Gandi 的 zone file。&lt;a href="http://spector.io/how-to-set-up-github-pages-with-a-custom-domain-on-gandi/"&gt;完整教學參考&lt;/a&gt; 接著原本的 github.io&amp;nbsp;網址就會被導到新網域。&lt;/p&gt;
&lt;p&gt;不夠清楚可以參考這篇 &lt;a href="https://blog.dmoon.tw/github-pages-custom-domain/index.html"&gt;blog&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;不過這裡有個要注意的，在編輯 zone file 時一定要確認編輯完成之後 Gandi 有吃到修改的設定檔，通常有吃到之後，下圖的 &lt;strong&gt;Operations&lt;/strong&gt; 會出現運作的數量，代表正在進行 &lt;span class="caps"&gt;DNS&lt;/span&gt; 設定。如果沒有就要注意一下。設定時間大概 40~60 min&amp;nbsp;會完成。&lt;/p&gt;
&lt;p&gt;&lt;img alt="#" src="/pics/201706/gandi_dash.png" /&gt;&lt;/p&gt;
&lt;h2&gt;Cloudflare&lt;/h2&gt;
&lt;p&gt;有了自訂網域名稱，而且也可以轉址但預設是 http，因此可以透過 Cloudflare 提供服務掛上&amp;nbsp;https。&lt;/p&gt;
&lt;p&gt;先到 &lt;a href="https://www.cloudflare.com/"&gt;Cloudflare&lt;/a&gt; 註冊一個帳號，接著會收到回傳信件，只要根據回傳信件內容到網站上面設定好網址。接著再將它提供的 dns 位置到 Gandi&amp;nbsp;去替換就完成囉。&lt;/p&gt;
&lt;p&gt;設定完成時在 &lt;strong&gt;overview&lt;/strong&gt;&amp;nbsp;畫面會顯示要你點擊測試，如果成功會顯示下面畫面：&lt;/p&gt;
&lt;p&gt;&lt;img alt="#" src="/pics/201706/Cloudflare_overview.png" /&gt;&lt;/p&gt;
&lt;p&gt;最後如果要成功掛上 https 需要針對瀏覽頁面設定 &lt;span class="caps"&gt;SSL&lt;/span&gt; 為 Flexible 才會顯示正確憑證，方法是在 Page rules 下增加一組 rules，以範例是指允許網域下所有頁面都透過 Flexible&amp;nbsp;認證方式：&lt;/p&gt;
&lt;p&gt;&lt;img alt="#" src="/pics/201706/Cloudflare_pagerules.png" /&gt;&lt;/p&gt;
&lt;p&gt;方法可以參考 &lt;a href="https://blog.dmoon.tw/github-pages-with-free-ssl/"&gt;blog&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;這邊要注意，前面 Gandi 的 zone settings 都設定完成再來啟用 Cloudflare，接著再回去設定 &lt;span class="caps"&gt;DNS&lt;/span&gt;，不然你先設定 Cloudflare, 會吃到 Gandi 不對的 zone file 設定，導致 Cloudflare 的 &lt;span class="caps"&gt;DNS&lt;/span&gt;&amp;nbsp;參數不正確。一般來說應該會只有三個：&lt;/p&gt;
&lt;p&gt;&lt;img alt="#" src="/pics/201706/Cloudflare_DNS.png" /&gt;&lt;/p&gt;
&lt;h2&gt;Disqus&amp;nbsp;留言轉換&lt;/h2&gt;
&lt;p&gt;簡單來說 Disqus 判斷一篇留言方式是透過網址，因為我們將 url 轉換到新的網域名稱自然而然原本的留言就會失效。不過 Disqus 有出一個不錯的工具叫 &lt;strong&gt;Migration Tools&lt;/strong&gt;&amp;nbsp;可以協助作轉換。&lt;/p&gt;
&lt;p&gt;登入 Disqus&amp;nbsp;打入以下網址：&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;https://{disqus_name}.disqus.com/admin/discussions/migrate/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;會顯示下圖 &lt;strong&gt;Upload a &lt;span class="caps"&gt;URL&lt;/span&gt; map&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img alt="#" src="/pics/201706/disqus_migrations.png" /&gt;&lt;/p&gt;
&lt;p&gt;點進去之後點選 &lt;code&gt;you can download a CSV here.&lt;/code&gt; 的按鈕，他會寄送一份 csv&amp;nbsp;檔案，接著叫照他的說明兩兩對照，舊在前新在後：&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;http://example.com/old-path/old/postb.html, http://example.com/new-path/new/postb.html
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;接著把改好的 csv 檔案上傳，根據網頁上是說最快 24hr 會全部轉換完成。但我只有 9 則留言，一下就轉換完成了 &lt;span class="caps"&gt;XD&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;如果我寫的太簡陋看不懂，可以參考&lt;a href="http://iotchef.cc/posts/2015-10-14-disqus-url-mapper-to-correct-post-url.html"&gt;這篇&lt;/a&gt;。&lt;/p&gt;</summary><category term="https"></category><category term="domain name"></category><category term="Cloudflare"></category><category term="gandi"></category></entry></feed>