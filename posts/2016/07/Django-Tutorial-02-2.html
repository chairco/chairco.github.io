<!DOCTYPE html>
<html lang="zh-hant">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="兩篇內容好像太長了，看了會有點辛苦。所以我把第二篇分成 2 篇。上篇建立了 model，也用了 Django 的 Admin module 讓我們可以手動建立資料，接著可以開始寫 views 讓使用者可以透過瀏覽器來操作這個 APP。 在開始動手寫程式之前要先瞭解一下 Django 這個 MTV 架構(Model-Template-View)。簡單來說在 Django 是使用 View ...">
        <meta name="keywords" content="Coding, Django">
        
        <link rel="icon" href="https://chairco.github.io/myfavicon.ico">
        <link rel="shortcut icon" href="https://chairco.github.io/myfavicon.ico" type="image/x-icon" />
        <link rel="Bookmark" href="https://chairco.github.io/myfavicon.ico" type="image/x-icon" />

        <title>Django教學第二篇-建立第一個APP(下) - Jason's Blog</title>

        <!-- Stylesheets -->
        <link href="https://chairco.github.io/theme/css/all.min.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="https://chairco.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jason's Blog Full Atom Feed" />
        <link href="https://chairco.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Jason's Blog Full RSS Feed" />
        <link href="https://chairco.github.io/feeds/django.atom.xml" type="application/atom+xml" rel="alternate" title="Jason's Blog Categories Atom Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-79798833-1', 'auto');
          ga('send', 'pageview');
        </script>
        <!-- /Google Analytics -->


    </head>

    <body>

        <!-- Header -->
    <div class="header-container" style="background: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)), url('https://chairco.github.io/images/home-bg.jpg'); background-position: center; background-size: cover;">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="https://chairco.github.io/"><img class="mr20" src="https://chairco.github.io/images/logo.png" alt="logo">Jason's Blog</a>
                    </div>
                    <div class="nav pull-right">
                                <a href="https://chairco.github.io/pages/about-me/">About</a>
                                <a href="https://chairco.github.io/cv">Resume</a>
                                <a href="https://chairco.github.io/categories.html">Categories</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">Django教學第二篇-建立第一個APP(下)</h1>
                      <p class="header-date">By <a href="https://chairco.github.io/author/jason.html">Jason</a>, Jul 04, 2016, in category <a href="https://chairco.github.io/category/django.html">Django</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="https://chairco.github.io/tag/coding.html">Coding</a>, <a href="https://chairco.github.io/tag/django.html">Django</a>                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <p>兩篇內容好像太長了，看了會有點辛苦。所以我把第二篇分成 2 篇。上篇建立了 model，也用了 Django 的 Admin module 讓我們可以手動建立資料，接著可以開始寫 views 讓使用者可以透過瀏覽器來操作這個 <span class="caps">APP</span>。</p>
<p>在開始動手寫程式之前要先瞭解一下 Django 這個 <a href="http://mropengate.blogspot.tw/2015/08/mvcdjangomtv.html" title="MTV(Model-Template-View)"><span class="caps">MTV</span></a> 架構(Model-Template-View)。簡單來說在 Django 是使用 View 去取得哪一筆資料並透過 Template&nbsp;決定怎麼呈現。</p>
<h3>第一個頁面</h3>
<p>首先先來設計一個 <code>base.html</code> 的 template。 因為我們希望每個 pages 儘量精簡，因此在 project 最外層資料夾建立一個 <code>templates/base/base.html</code> 讓所有頁面可以繼承它。然後同時也建立一個 <code>static/base/...</code> 來放一些 css、js&nbsp;檔案</p>
<p>直接看結構吧:</p>
<div class="codehilite"><pre><span></span>borrow
├── borrow
│   ├── __init__.py
│   └── 略...
├── loans
│   ├── __init__.py
│   ├── 略...
│   └── templates
│       └── loans
│           ├── _base.html
│           └── home.html
├── static
│   └── base
│       ├── css
│       │   └── 略...
│       └── js
│           └── 略...
└── templates
    └── base
        └── base.html
</pre></div>


<p>做完之後很重要一點是要修改 <code>settings/base.py</code> 裡 <code>TEMPLATES</code> 變數告訴 Django 新的 templates&nbsp;位置:</p>
<div class="codehilite"><pre><span></span>TEMPLATES = [
    {
        &#39;BACKEND&#39;: &#39;django.template.backends.django.DjangoTemplates&#39;,
        &#39;DIRS&#39;: [
                    os.path.join(BASE_DIR, &#39;templates&#39;).replace(&#39;\\&#39;, &#39;/&#39;),
                    os.path.join(BASE_DIR, &#39;templates/base&#39;).replace(&#39;\\&#39;, &#39;/&#39;),
        ],
略...
</pre></div>


<p>然後也新增 <code>STATICFILES_DIRS</code> 變數讓 Django 知道 static 位置(這個 folder 用來放 css, js 的&nbsp;檔案):</p>
<div class="codehilite"><pre><span></span>STATICFILES_DIRS = (
    os.path.join(BASE_DIR, &quot;static&quot;),
)
</pre></div>


<p>前面我們有提到在 Django View 是用來取得資料並且用 Template 來呈現資料樣貌，所以接下來我們可以開發第一個 view 了，打開 loans/views.py，然後鍵入下面的 code，這段 code 就是建立 function home 然後印出 <code>home.html</code> 這個頁面:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;loans/home.html&#39;</span><span class="p">)</span>
</pre></div>


<p>接著要讓 Django 透過 <span class="caps">WSGI</span> 來拜訪這個頁面，因次我們打開 <code>borrow/urls.py</code> 來設定 routing&nbsp;的位置:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">loans.views</span> <span class="kn">import</span> <span class="n">home</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^admin/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^$&#39;</span><span class="p">,</span> <span class="n">home</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>


<p>Django 是用正規表達式 (Regular Expression) 來處理所有 urls pattern 的 routing, ，因此只要告訴 urls pattern function home&nbsp;的位置就可以了囉。</p>
<p>但突然想起一件事，還沒有建立 template&nbsp;呀！對，這才要回應前面第一段目的，在這邊我們的繼承關係會是這樣:</p>
<div class="codehilite"><pre><span></span> templates/base/base.html
         ＾
         ｜       
 loans/templates/loans/_base.html 
         ＾
         ｜ 
 loans/templates/loans/home.html 
</pre></div>


<p>有點繁瑣，講一下概念:</p>
<ul>
<li><code>templates/base/base.html</code>: 所有 app 網頁的 base，像 nav&nbsp;等物件都放在這邊。</li>
<li><code>loans/templates/loans/_base.html</code>: 這是每一個 app 的 base，這邊可以設定 <code>&lt;body&gt;&lt;/body&gt;</code></li>
<li><code>loans/templates/loans/home.html</code>: 實際處理內容的&nbsp;template</li>
</ul>
<p>所以 template 的 code&nbsp;會長成這樣:</p>
<div class="codehilite"><pre><span></span><span class="c">{# base/base.html #}</span>
<span class="cp">{%</span> <span class="k">load</span> <span class="nv">staticfiles</span> <span class="cp">%}</span>

<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;title&gt;</span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span>物品借用系統<span class="cp">{%</span> <span class="k">endblock</span> <span class="nv">title</span> <span class="cp">%}</span><span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href=</span><span class="s">&quot;//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
<span class="nt">&lt;nav</span> <span class="na">class=</span><span class="s">&quot;navbar navbar-default navbar-static-top&quot;</span> <span class="na">role=</span><span class="s">&quot;navigation&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;navbar-header&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;navbar-brand&quot;</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;home&#39;</span> <span class="cp">%}</span><span class="s">&quot;</span><span class="nt">&gt;</span>物品借用系統<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/nav&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="nv">body</span> <span class="cp">%}</span>

<span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;//code.jquery.com/jquery-2.1.1.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;</span><span class="cp">{%</span> <span class="k">static</span> <span class="s1">&#39;base/js/base.js&#39;</span> <span class="cp">%}</span><span class="s">&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">js</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="nv">js</span> <span class="cp">%}</span>

<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="c">{# loans/_base.html #}</span>
<span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;base.html&#39;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
<span class="cp">{{</span> <span class="nb">block</span><span class="nv">.super</span> <span class="cp">}}</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span><span class="nt">&gt;</span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="nv">content</span> <span class="cp">%}</span><span class="nt">&lt;/div&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="nv">body</span> <span class="cp">%}</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="c">{# loans/home.html #}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;loans/_base.html&#39;</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="nv">content</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>


<p>輸入 <code>http://localhost:8000/</code> 看看是不是跑出畫面了呢？</p>
<p><img alt="django-tutorial-ch2-2-p1" src="/pics/201607/django-tutorial-ch2-2-p1.png" /></p>
<hr />
<p>有一點成就感了嗎？ 其實 Django&nbsp;架構真的很複雜，第一次總會遇到些問題打擊信心，但一步步慢慢來總是可以學會。然後隨著架構愈趨複雜你會發現這些前置步驟的重要性。</p>
<p>先喘一下，我們會加快腳步用最快速度把第一個系統建立起來囉。</p>
<hr />
<h3>進入開發第一步</h3>
<p>接下來我們要建立一個借用系統表單流程，這個流程的使用者情境 (user story)&nbsp;應該會是這樣:</p>
<div class="codehilite"><pre><span></span>新增表單 -&gt; 填寫表單 -&gt; 送出表單
</pre></div>


<p>但對於系統開發流程大體來說會是這樣:</p>
<div class="codehilite"><pre><span></span>1. 新增表單 -&gt; [urls pattern 找到對應 view] -&gt; [view 根據對應 template] -&gt; [顯示 html]
2. 填寫表單 -&gt; [view 根據 form 找到 model ] -&gt; [ 印出對應欄位給使用者填寫 ] -&gt; [如果有多筆 device， 按下增加按鈕就會透過 js 新增一個欄位給使用者填寫]
3. 送出表單 -&gt; [view 會檢查欄位內容的型態是否正確] -&gt; [正確就會存進資料庫] -&gt; [網站轉址]
</pre></div>


<p>所以我們在開發順序的思維就會是</p>
<ul>
<li>建立 view (當需要輸入資料庫就需要編輯&nbsp;form)</li>
<li>透過 template&nbsp;呈現畫面</li>
<li>urls pattern 告訴 django&nbsp;連接對應的頁面</li>
</ul>
<p>還記得一開始時我們在 admin module 建立了幾筆資料嗎？ 那就先從印出資料畫面著手吧，首先打開 <code>loans/views.py</code>。</p>
<p>這邊會捨棄 <span class="caps">FBV</span>(Function-Based-View) 直接用 <span class="caps">CBV</span>(Class-Based-View) 來做開發<sup id="fnref:1"><a class="footnote-ref" href="#fn:1" rel="footnote">1</a></sup>，程式碼會長這樣:</p>
<div class="codehilite"><pre><span></span><span class="c1">#  loans/views.py</span>
<span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="kn">import</span> <span class="n">ListView</span>

<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Loan</span>

<span class="k">class</span> <span class="nc">LoanList</span><span class="p">(</span><span class="n">ListView</span><span class="p">):</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Loan</span>
</pre></div>


<p>你沒看錯，就短短的幾行這就是 <span class="caps">CBV</span> 威力。我們透過繼承 <code>ListView</code> 這個 class，然後呼叫 as_view() 這個 function 印出 model 內所有值<sup id="fnref:3"><a class="footnote-ref" href="#fn:3" rel="footnote">3</a></sup>。</p>
<p>接著就是撰寫 template 來呈現資料樣貌，所以我們在 <code>loans/templates/loans/</code> 底下新增一個 <code>loan_list.html</code> 然後裡面的程式碼如下:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span><span class="c1"># loans/loan_list.html #}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">extends</span> <span class="s1">&#39;loans/_base.html&#39;</span> <span class="o">%</span><span class="p">}</span>

<span class="p">{</span><span class="o">%</span> <span class="n">block</span> <span class="n">title</span> <span class="o">%</span><span class="p">}</span><span class="n">Loans</span> <span class="o">|</span> <span class="p">{{</span> <span class="n">block</span><span class="o">.</span><span class="n">super</span> <span class="p">}}{</span><span class="o">%</span> <span class="n">endblock</span> <span class="n">title</span> <span class="o">%</span><span class="p">}</span>

<span class="p">{</span><span class="o">%</span> <span class="n">block</span> <span class="n">content</span> <span class="o">%</span><span class="p">}</span>
    <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;page-header&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">a</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;btn btn-primary pull-right&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;{</span><span class="si">% u</span><span class="s2">rl &#39;loan_add&#39; %}&quot;</span><span class="o">&gt;</span><span class="n">Add</span> <span class="n">Loan</span> <span class="n">Request</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">Loan</span> <span class="n">List</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>

    <span class="o">&lt;</span><span class="n">table</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;table table-striped&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;</span><span class="c1">#&lt;/th&gt;</span>
            <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;</span><span class="n">purpose</span><span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;</span><span class="n">owner</span><span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;</span><span class="n">created_at</span><span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="nb">object</span> <span class="ow">in</span> <span class="n">object_list</span> <span class="o">%</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="p">{{</span> <span class="nb">object</span><span class="o">.</span><span class="n">id</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;{{ object.get_absolute_url }}&quot;</span><span class="o">&gt;</span><span class="p">{{</span> <span class="nb">object</span><span class="o">.</span><span class="n">purpose</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="o">&gt;</span><span class="p">{{</span> <span class="nb">object</span><span class="o">.</span><span class="n">owner</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="p">{{</span> <span class="nb">object</span><span class="o">.</span><span class="n">created_at</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
    <span class="o">&lt;/</span><span class="n">table</span><span class="o">&gt;</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endblock</span> <span class="n">content</span> <span class="o">%</span><span class="p">}</span>
</pre></div>


<p>首先不要忘記繼承 <code>loans/_base.html</code> 這個 template，然後在 <code>{% block content %}{% endblock content %}</code> 的內容之間撰寫 <span class="caps">HTML</span>&nbsp;的程式碼。</p>
<p>這個頁面我希望用表格方式顯示，所以用 for 迴圈把從 <code>views.py</code> 內取得的回傳得值 <code>object_list</code> 資料印出來。</p>
<p>其中一行程式碼 <code>{% url 'loan_add' %}</code> 要先改成 <code>#</code> 因為 <code>loan_add</code> 是我們在 urls pattern 可用來代換的名稱，因為當我們有一天修改 urls pattern 裡對應 <code>views.py</code> 的函式時，就不需要再去修改 template&nbsp;內的超連結網址囉。</p>
<p>但是目前在 urls pattern 內還沒有這個名稱，所以我們就先用 <code>#</code> 來代替，不然網頁執行就會因為找不到名稱而出錯。</p>
<p>最後只要在 urls.py 建立 pattern。先跳出來說明，Django 專案建立時會在專案名稱目錄下產生一個 <code>urls.py</code> 以這個範例來看就是位於環境變數的資料夾底下 <code>borrow/urls.py</code>。</p>
<p>但你要想想，一個專案可能有很多 <span class="caps">APP</span>，而這些 <span class="caps">APP</span> 可能有一些類似功能，我們總不希望把所有 pattern 扁平化吧？還是希望分層，如果根據 <span class="caps">APP</span>&nbsp;名稱會是不錯的方法。因此一個網站的分類就會如下:</p>
<div class="codehilite"><pre><span></span><span class="n">localhost</span><span class="o">:</span><span class="mi">8000</span><span class="o">/</span>
<span class="n">localhost</span><span class="o">:</span><span class="mi">8000</span><span class="sr">/aaa/</span><span class="n">list</span>
<span class="n">localhost</span><span class="o">:</span><span class="mi">8000</span><span class="sr">/bbb/</span><span class="n">list</span>
</pre></div>


<p>所以有這個觀念後就在 <code>loans/</code> 路徑底下建立一個 <code>urls.py</code>，所以你看到的結構會是這樣</p>
<div class="codehilite"><pre><span></span>borrow
├── borrow
│   ├── __init__.py
│   ├── 略...
│   ├── urls.py
│   └── wsgi.py
└── loans
    ├── __init__.py
    ├── 略...
    ├── urls.py
    └── views.py
</pre></div>


<p>所以我們要在 <code>borrow/urls.py</code> 告訴他 <span class="caps">APP</span> loans 的位置，然後再到 <code>loans/urls.py</code> 設定 <code>loan_list</code></p>
<div class="codehilite"><pre><span></span><span class="c1"># borrow/urls.py</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">loans.views</span> <span class="kn">import</span> <span class="n">home</span>


<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^admin/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^loan/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;loans.urls&#39;</span><span class="p">)),</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^$&#39;</span><span class="p">,</span> <span class="n">home</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;home&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="c1"># loans/urls.py</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>


<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">LoanList</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;loan_list&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>


<p>設定完之後，我們打開瀏覽器打入網址 <code>http://localhost:8000/loan/</code> 看看是不是輸入的資料都跑出來了呢？</p>
<p><img alt="django-tutorial-ch2-2-p2" src="/pics/201607/django-tutorial-ch2-2-p2.png" /></p>
<p>哇，有沒有發現其實開發網頁並沒有想像中的困難嘛，接下來我們就照著這樣的開發思維接著進入下一個流程，建立一個頁面讓使用者可以填單囉。(再複習一次):</p>
<ul>
<li>建立 view (當需要輸入資料庫就需要編輯&nbsp;form)</li>
<li>透過 template&nbsp;呈現畫面</li>
<li>urls pattern 告訴 django&nbsp;連接對應的頁面</li>
</ul>
<p>教學還是有點冗長，但已經陳述了一個基本的開發流程。
接下來我們要正式進入第三篇 <em>建立 <span class="caps">MODEL</span> 和用 <span class="caps">CBV</span> 來做程式開發</em> 把我們的第一個 Django&nbsp;網站建立起來！</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>使用過 Class 類別都知道在開發程式碼時有時我們會儘量避免重複的程式碼一直出現，在 python 裡有一個格言是 there should be one—and preferably only one—obvious way to do it<sup id="fnref:2"><a class="footnote-ref" href="#fn:2" rel="footnote">2</a></sup> 中文翻譯 &#8220;用一種方法，最好是只有一種方法來做一件事&#8221;。 <span class="caps">CBV</span> 就是用繼承方式避免重複的程式碼不斷發生，可參考 <span class="caps">TP</span> 這一篇 <a href="https://github.com/uranusjr/django-tutorial-for-programmers/blob/master/19-class-based-view.md">class-based-view</a>。&#160;<a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Peters, Tim (19 August 2004). <a href="https://www.python.org/dev/peps/pep-0020/"><span class="caps">PEP</span> 20 – The Zen of Python</a>. Python Enhancement Proposals. Python Software Foundation. Retrieved 24 November 2008.&#160;<a class="footnote-backref" href="#fnref:2" rev="footnote" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>關於詳細的實作可以參考 <a href="http://ccbv.co.uk/projects/Django/1.9/django.views.generic.list/ListView/">ccbv ListView</a>&#160;<a class="footnote-backref" href="#fnref:3" rev="footnote" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div>


    <div class="comments">
        <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'chairco';
                var disqus_identifier = 'posts/2016/07/Django-Tutorial-02-2.html';
                var disqus_url = 'https://chairco.github.io/posts/2016/07/Django-Tutorial-02-2.html';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
        <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>
        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="https://chairco.github.io/archives.html">Archives</a></li>
                            <li><a href="https://chairco.github.io/tags.html">Tags</a></li>
                            <li><a href="https://chairco.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>
                            <li><a href="https://chairco.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate">RSS Feed</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Social</div>
                        <ul class="list-unstyled">
                            <li><a href="https://github.com/chairco" target="_blank">Github</a></li>
                            <li><a href="https://twitter.com/ChaircoChen" target="_blank">Twitter</a></li>
                            <li><a href="mailto:chairco@gmail.com" target="_blank">Email</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; Jason's Blog 2018</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>